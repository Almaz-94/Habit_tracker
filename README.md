# SPA приложение - трекер привычек



## Для работы с проектом необходимо выполнить следующие действия:

- Клонировать репозиторий.
- Установить зависимости pip install -r requirements.txt
- Создать файл .env, заполнить его данными из файла env.sample
- Установить и запустить Redis
- Создать базу данных в PostgreSQL CREATE DATABASE <DBname>
- Создать миграции: python manage.py makemigrations 
- Применить миграции: python manage.py migrate
- Запустить проект python manage.py runserver
- Запустить celery worker командой: celery -A config worker -l info -P eventlet, celery -A config Beat -l info -S django
- Запустить celery beat командой: celery -A config beat -l INFO --scheduler django_celery_beat.schedulers:DatabaseScheduler

## Решены следующие задачи:

- Настроен CORS
- Настроена интеграция с Telegram
- Реализована пагинация
- Использованы переменные окружения
- Настроены валидаторы
- Описанные права доступа заложены
- Настроена отложенная задача через Celery


## Модель Привычка (habits.Habit):

- creator — создатель привычки (FK users.User).
- place — место, в котором необходимо выполнять привычку.
- time — время, когда необходимо выполнять привычку.
- action — действие, которое представляет собой привычка.
- is_pleasant — привычка "приятная" (True/False).
- linked_habit — приятная привычка, связанная с полезной привычкой (FK habits.Habit).
- period — периодичность выполнения привычки в днях.
- reward — награда за выполнение привычки.
- duration_time — время, которое, предположительно, потратит пользователь на выполнение привычки.
- is_public — опубликовать свою привычку (True/False)
- beginning_date — дата следующего выполнения привычки по расписанию

## Модель Пользователь (users.User):

- username - логин пользователя
- chat_id - id чата пользователя в приложении Телеграм
- telegram_username - ник пользователя в приложении Телеграм
  
## Валидаторы

- Исключена возможность одновременного выбора связанной привычки и вознаграждения.
- Время выполнения должно быть не больше 120 секунд.
- В связанные привычки могут попадать только привычки с признаком приятной привычки.
- У приятной привычки не может быть вознаграждения или связанной привычки.
- Нельзя выполнять привычку реже, чем 1 раз в 7 дней.

## Пагинация

Для вывода списка привычек реализована пагинацию с выводом по 5 привычек на страницу.

## Права доступа

- Каждый пользователь имеет доступ только к своим привычкам по механизму CRUD.
- Пользователь может видеть список публичных привычек без возможности их как-то редактировать или удалять.

## Эндпоинты

- Регистрация
- Авторизация
- Список публичных привычек с привычками текущего пользователя с пагинацией
- Создание привычки
- Редактирование привычки
- Удаление привычки
- Получение ссылки на телеграм бота

## Интеграция

Для работы сервиса реализована работа с отложенными задачами для напоминания о том, в какое время какие привычки необходимо выполнять.
Для этого реализована интеграция сервиса с мессенджером Telegram, через который производится рассылка уведомлений.


## Документация

Документация для API реализована с помощью drf-yasg и находится на следующих эндпоинтах:

- http://127.0.0.1:8000/docs/
- http://127.0.0.1:8000/redoc/
